<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Certificate login</title>
</head>
<body>
    <div class="box" id="step2">
        <h2> Certificate Authentication </h2>
        <form id="certform">
            Upload Certificate: <input type="file" id="certificate" accept=".crt,.pem"><br><br>
            <input type="submit" value="Login">
        </form>
    </div>
</body>
</html>
<script type="text/javascript">
    //second factor authentication through certificate authetication
    function sslLogin(){
        document.getElementById('certForm').onsubmit = async (e) => {
            e.preventDefault();
            const cert = document.getElementById('certificate').files[0];
            try {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if(e.target.result.includes('-----BEGIN CERTIFICATE-----')) {
                        alert('Access granted');
                        window.location = 'rebel_site.html';
                    } 
                    else {
                        alert('Invalid certificate');
                    }
                };
                reader.readAsText(cert);
            } catch(err) {
                alert('Error processing certificate');
            }
        }
    };
</script>